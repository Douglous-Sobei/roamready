(()=>{"use strict";var e,t={1839:(e,t,o)=>{o(6981);var a=o(2861);const s=()=>{const e=document.querySelector(".alert");e&&e.parentElement.removeChild(e)},r=(e,t)=>{s();const o=`<div class="alert alert--${e}">${t}</div>`;document.querySelector("body").insertAdjacentHTML("afterbegin",o),window.setTimeout(s,5e3)},n=async(e,t)=>{try{const o="password"===t?"/api/v1/users/updateMyPassword":"/api/v1/users/updateMe";"success"===(await(0,a.Z)({method:"PATCH",url:o,data:e})).data.status&&r("success",`${t.toUpperCase()} updated successfully`)}catch(e){r("error",e.response.data.message)}},d=Stripe("pk_test_51NxsCeLesQGFcRO2gcUIxnASjVAiZntX3xwWZClHvVbQ6edjjmM79cUSKlxJSzJb9itHSYXX1pLbAJYzzWZzu8ii00xZOFsqur"),c=document.getElementById("map"),u=document.querySelector(".form--login"),l=document.querySelector(".nav__el--logout"),i=document.querySelector(".form-user-data"),p=document.querySelector(".form-user-password"),m=document.getElementById("book-tour");if(c){(e=>{mapboxgl.accessToken="pk.eyJ1IjoiZG91Z2xvdXMtc29iZWkiLCJhIjoiY2xtejMxdTlqMGs0MDJxbno5ZW1iaWIzbCJ9.5CCjoaJ7RxnKWdL2S0qMWg";var t=new mapboxgl.Map({container:"map",style:"mapbox://styles/douglous-sobei/cln3pkzwo003801p9fl709ipb",scrollZoom:!1});const o=new mapboxgl.LngLatBounds;e.forEach((e=>{const a=document.createElement("div");a.className="marker",new mapboxgl.Marker({element:a,anchor:"bottom"}).setLngLat(e.coordinates).addTo(t),new mapboxgl.Popup({offset:30}).setLngLat(e.coordinates).setHTML(`<p>Day ${e.day}: ${e.description}</p>`).addTo(t),o.extend(e.coordinates)})),t.fitBounds(o,{padding:{top:200,bottom:150,left:100,right:100}})})(JSON.parse(c.dataset.locations))}u&&u.addEventListener("submit",(e=>{e.preventDefault();(async(e,t)=>{try{"success"===(await(0,a.Z)({method:"POST",url:"/api/v1/users/login",data:{email:e,password:t}})).data.status&&(r("success","Logged in successfully"),window.setTimeout((()=>{location.assign("/")}),1500))}catch(e){r("error",e.response.data.message)}})(document.getElementById("email").value,document.getElementById("password").value)})),l&&l.addEventListener("click",(async()=>{try{((await(0,a.Z)({method:"GET",url:"/api/v1/users/logout"})).data.status="success")&&location.reload(!0)}catch(e){console.log(e.response),r("error","Error logging out! Try again.")}})),i&&i.addEventListener("submit",(e=>{e.preventDefault();const t=new FormData;t.append("name",document.getElementById("name").value),t.append("email",document.getElementById("email").value),t.append("photo",document.getElementById("photo").files[0]),n(t,"data")})),p&&p.addEventListener("submit",(async e=>{e.preventDefault(),document.querySelector(".btn--save-password").textContent="Updating...";const t=document.getElementById("password-current").value,o=document.getElementById("password").value,a=document.getElementById("password-confirm").value;await n({passwordCurrent:t,password:o,passwordConfirm:a},"password"),document.querySelector(".btn--save-password").textContent="Save password",document.getElementById("password-current").value="",document.getElementById("password").value="",document.getElementById("password-confirm").value=""})),m&&m.addEventListener("click",(e=>{e.target.textContent="Processing...";const{tourId:t}=e.target.dataset;(async e=>{try{const t=await(0,a.Z)(`/api/v1/bookings/checkout-session/${e}`);await d.redirectToCheckout({sessionId:t.data.session.id})}catch(e){console.log(e),r("error",e)}})(t)}))}},o={};function a(e){var s=o[e];if(void 0!==s)return s.exports;var r=o[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.m=t,e=[],a.O=(t,o,s,r)=>{if(!o){var n=1/0;for(l=0;l<e.length;l++){for(var[o,s,r]=e[l],d=!0,c=0;c<o.length;c++)(!1&r||n>=r)&&Object.keys(a.O).every((e=>a.O[e](o[c])))?o.splice(c--,1):(d=!1,r<n&&(n=r));if(d){e.splice(l--,1);var u=s();void 0!==u&&(t=u)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[o,s,r]},a.d=(e,t)=>{for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};a.O.j=t=>0===e[t];var t=(t,o)=>{var s,r,[n,d,c]=o,u=0;if(n.some((t=>0!==e[t]))){for(s in d)a.o(d,s)&&(a.m[s]=d[s]);if(c)var l=c(a)}for(t&&t(o);u<n.length;u++)r=n[u],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(l)},o=self.webpackChunk_4_natours=self.webpackChunk_4_natours||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))})();var s=a.O(void 0,[18],(()=>a(1839)));s=a.O(s)})();